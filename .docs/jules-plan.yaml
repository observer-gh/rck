version: 1
project: multi-page-demo-split
generated: 2025-10-16
description: Focused plan to implement ONLY a multi-page separation (user vs admin) inside the existing Streamlit app for demo purposes. All prior phases removed intentionally.

phase:
  id: 1
  key: multi-page-split
  goal: Separate user and admin flows with a dynamic page registry & admin toggle (no real auth).

tasks:
  - id: p1.audit_current_app
    desc: Inventory existing app.py sections and label user/admin/mixed.
    exec:
      type: manual
      steps:
        - list functions & UI blocks
    verify:
      - notes_created: docs/app_audit.md
    tags: [analysis]

  - id: p1.router_scaffold
    desc: Add page registry + sidebar selectbox router.
    depends_on: [p1.audit_current_app]
    exec:
      type: code
      steps:
        - create registry {key:{label,fn,admin}}
    verify:
      - test: registry_excludes_admin_when_false
    tags: [structure]

  - id: p1.extract_pages
    desc: Extract page functions (profile,my_club,activity,how_it_works,demo_script,admin_dashboard).
    depends_on: [p1.router_scaffold]
    exec:
      type: code
      steps:
        - move code blocks into discrete fns
    verify:
      - test: import_pages_no_errors
    tags: [refactor]

  - id: p1.admin_toggle
    desc: Add admin_mode checkbox controlling registry filtering.
    depends_on: [p1.extract_pages]
    exec:
      type: code
      steps:
        - add st.sidebar.checkbox -> session_state.admin_mode
    verify:
      - test: admin_page_hidden_when_off
    tags: [ui]

  - id: p1.banner
    desc: Show top banner when admin_mode true.
    depends_on: [p1.admin_toggle]
    exec:
      type: code
      steps:
        - conditional st.markdown banner
    verify:
      - test: banner_only_admin
    tags: [ux]

  - id: p1.admin_dashboard_tabs
    desc: Convert admin functions into tabbed dashboard (matching, clubs, reports, data, analytics).
    depends_on: [p1.extract_pages]
    exec:
      type: code
      steps:
        - implement st.tabs
    verify:
      - test: tabs_render_admin_only
    tags: [ui]

  - id: p1.placeholder_my_club
    desc: Placeholder message when no club assigned.
    depends_on: [p1.extract_pages]
    exec:
      type: code
      steps:
        - conditional render
    verify:
      - test: placeholder_when_none
    tags: [ux]

  - id: p1.components_module
    desc: Create ui/components.py (user_badge, club_card, metric_chip).
    depends_on: [p1.extract_pages]
    exec:
      type: code
      steps:
        - new module + usages
    verify:
      - test: components_import
    tags: [structure]

  - id: p1.danger_zone_guard
    desc: Second confirm checkbox around destructive reset.
    depends_on: [p1.admin_dashboard_tabs]
    exec:
      type: code
      steps:
        - require confirm2 True
    verify:
      - test: cannot_reset_without_confirm2
    tags: [safety]

  - id: p1.basic_analytics
    desc: Minimal counts (users, clubs, verified_reports) tab section.
    depends_on: [p1.admin_dashboard_tabs]
    exec:
      type: code
      steps:
        - aggregate + display
    verify:
      - test: analytics_counts_positive
    tags: [analytics]

  - id: p1.demo_script_page
    desc: User-visible Demo Script static page.
    depends_on: [p1.extract_pages]
    exec:
      type: content
      steps:
        - add markdown instructions
    verify:
      - manual: page_renders
    tags: [docs, ux]

  - id: p1.smoke_tests
    desc: Smoke tests for router & admin visibility.
    depends_on: [p1.admin_toggle]
    exec:
      type: code
      steps:
        - create tests/test_view_split_smoke.py
    verify:
      - test: view_split_smoke
    tags: [testing]

  - id: p1.readme_refresh
    desc: Rewrite .docs/README.md to match new scope only.
    depends_on: [p1.smoke_tests]
    exec:
      type: doc
      steps:
        - update summary
    verify:
      - file_contains: multi-page split
    tags: [documentation]

status_placeholders:
  default: pending
  allowed: [pending, in_progress, blocked, done, failed]

notes:
  - Starting over: prior phases intentionally removed for focus.
  - Add real auth later by replacing admin_mode gate.
  - Keep tasks atomic (<1 day) for rapid iteration.
